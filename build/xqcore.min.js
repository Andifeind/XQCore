/*!
 * XQCore - 0.4.28
 * 
 * Model View Presenter Javascript Framework
 *
 * XQCore is licenced under MIT Licence
 * http://opensource.org/licenses/MIT
 *
 * Copyright (c) 2012 - 2013 Noname Media, http://noname-media.com
 * Author Andi Heinkelein
 *
 * Creation Date: 2013-12-03
 */
(function(t,e){"function"==typeof define&&define.amd?define("xqcore",["jquery","handlebars"],e):"undefined"!=typeof module&&module.exports?module.exports=e(require("jquery"),require("handlebars")):t.XQCore=e(t.jQuery,t.Handlebars)})(this,function(t,e){var n={version:"0.4.28",defaultRoute:"default",html5Routes:!1,hashBang:"#!",callerEvent:"callerEvent"};return n.extend=t.extend,n._dump={},n.dump=function(t){return n._dump[t]?(console.log("[XQCore dump]",t,n._dump[t]),n._dump[t]):!1},n.Event=function(){"use strict";/*!
	 * EventEmitter v4.2.5 - git.io/ee
	 * Oliver Caldwell
	 * MIT license
	 * @preserve
	 */
function t(){}function e(t,e){for(var n=t.length;n--;)if(t[n].listener===e)return n;return-1}function n(t){return function(){return this[t].apply(this,arguments)}}var i=t.prototype;return i.getListeners=function(t){var e,n,i=this._getEvents();if("object"==typeof t){e={};for(n in i)i.hasOwnProperty(n)&&t.test(n)&&(e[n]=i[n])}else e=i[t]||(i[t]=[]);return e},i.flattenListeners=function(t){var e,n=[];for(e=0;t.length>e;e+=1)n.push(t[e].listener);return n},i.getListenersAsObject=function(t){var e,n=this.getListeners(t);return n instanceof Array&&(e={},e[t]=n),e||n},i.addListener=function(t,n){var i,r=this.getListenersAsObject(t),s="object"==typeof n;for(i in r)r.hasOwnProperty(i)&&-1===e(r[i],n)&&r[i].push(s?n:{listener:n,once:!1});return this},i.on=n("addListener"),i.addOnceListener=function(t,e){return this.addListener(t,{listener:e,once:!0})},i.once=n("addOnceListener"),i.defineEvent=function(t){return this.getListeners(t),this},i.defineEvents=function(t){for(var e=0;t.length>e;e+=1)this.defineEvent(t[e]);return this},i.removeListener=function(t,n){var i,r,s=this.getListenersAsObject(t);for(r in s)s.hasOwnProperty(r)&&(i=e(s[r],n),-1!==i&&s[r].splice(i,1));return this},i.off=n("removeListener"),i.addListeners=function(t,e){return this.manipulateListeners(!1,t,e)},i.removeListeners=function(t,e){return this.manipulateListeners(!0,t,e)},i.manipulateListeners=function(t,e,n){var i,r,s=t?this.removeListener:this.addListener,o=t?this.removeListeners:this.addListeners;if("object"!=typeof e||e instanceof RegExp)for(i=n.length;i--;)s.call(this,e,n[i]);else for(i in e)e.hasOwnProperty(i)&&(r=e[i])&&("function"==typeof r?s.call(this,i,r):o.call(this,i,r));return this},i.removeEvent=function(t){var e,n=typeof t,i=this._getEvents();if("string"===n)delete i[t];else if("object"===n)for(e in i)i.hasOwnProperty(e)&&t.test(e)&&delete i[e];else delete this._events;return this},i.removeAllListeners=n("removeEvent"),i.emitEvent=function(t,e){var n,i,r,s,o=this.getListenersAsObject(t);for(r in o)if(o.hasOwnProperty(r))for(i=o[r].length;i--;)n=o[r][i],n.once===!0&&this.removeListener(t,n.listener),s=n.listener.apply(this,e||[]),s===this._getOnceReturnValue()&&this.removeListener(t,n.listener);return this},i.trigger=n("emitEvent"),i.emit=function(t){var e=Array.prototype.slice.call(arguments,1);return this.emitEvent(t,e)},i.setOnceReturnValue=function(t){return this._onceReturnValue=t,this},i._getOnceReturnValue=function(){return this.hasOwnProperty("_onceReturnValue")?this._onceReturnValue:!0},i._getEvents=function(){return this._events||(this._events={})},t}(),n.Logger=function(){"use strict";function t(t){return 1e3>t?t+" ms":6e4>t?Math.round(t/100)/10+" sec":Math.round(t/6e4)+" min "+Math.round(t%6e4/1e3)+" sec"}var e=function(){};return e.prototype.log=function(){var t;this.debug&&(t=Array.prototype.slice.call(arguments),t.unshift("["+this.name+"]"),console.log.apply(console,t))},e.prototype.warn=function(){var t;this.debug&&(t=Array.prototype.slice.call(arguments),t.unshift("["+this.name+"]"),console.warn.apply(console,t))},e.prototype.error=function(){var t;this.debug&&(t=Array.prototype.slice.call(arguments),t.unshift("["+this.name+"]"),console.error.apply(console,t))},e.prototype.timer=function(e){var n={start:null,stop:null,name:e,logger:this,end:function(){this.stop=Date.now(),this.logger.log("Timer "+this.name+" runs: ",t(this.stop-this.start))}};return this.log("Start Timer",e),n.start=Date.now(),n},e.prototype.__scope={getHumanTime:t},e}(),n.GetSet=function(t){"use strict";var e=function(t){this.properties={},this._isValid=!1,t&&(this.schema=t.schema,this.debug=Boolean(t.debug)),this.name="GetSet",n.extend(this,new n.Event)},i=function(t,e){return t&&(t=t.split("."),t.forEach(function(t){e=e[t]})),e};return n.extend(e.prototype,new n.Logger),e.prototype.set=function(){var t,e,n={},i=this.get();if(null===arguments[0])n=arguments[1],this.log("Set data",n,i);else if("object"==typeof arguments[0])n=arguments[0],this.log("Set data",n,i);else if("string"==typeof arguments[0]){n=this.get(),e=arguments[0];var r=arguments[1];n[e]=r,this.log("Set data",n,i)}else this.warn("Data are incorrect in getset.set()",arguments);return this.schema&&(t=this.validate(n),null!==t)?(this.warn("Validate error in getset.set",t),this.emit("validation.error",t),!1):this.customValidate&&(t=this.customValidate(n),null!==t)?(this.warn("Validate error in getset.set",t),this.emit("validation.error",t),!1):(this.properties=n,this.emit("data.change",n,i),e&&this.emit("change."+e,n[e]),!0)},e.prototype.get=function(e){return e===t?this.properties:this.properties[e]},e.prototype.has=function(t){return!!this.properties[t]},e.prototype.reset=function(){this.log("Reset getset"),this.properties={},this.removeAllListener()},e.prototype.append=function(t,e){1===arguments.length&&(e=t,t=null);var n=this.properties,i=this.get(),r=!0;return t&&t.split(".").forEach(function(t){n=n[t]}),n instanceof Array?n.push(e):null===t?(this.properties=[e],n=this.get()):this.warn("GetSet.append requires an array. Dataset isn't an array",t),r&&this.emit("data.change",n,i),e},e.prototype.prepend=function(t,e){1===arguments.length&&(e=t,t=null);var n=this.properties,i=this.get(),r=!0;return t&&t.split(".").forEach(function(t){n=n[t]}),n instanceof Array?n.unshift(e):null===t?(this.properties=[e],n=this.get()):this.warn("GetSet.append requires an array. Dataset isn't an array",t),r&&this.emit("data.change",n,i),e},e.prototype.remove=function(t,e){var n=this.properties,i=null;return t.split(".").forEach(function(t){n=n[t]}),n instanceof Array?(i=n.splice(e,1),i=i[0]||null):this.warn("getset.remove() doesn't work with Objects in getset",this.name),i},e.prototype.search=function(t,e){var n=i(t,this.properties);if(n)for(var r=0;n.length>r;r++){var s,o=n[r];for(var a in e)if(e.hasOwnProperty(a)){if(!o[a]||o[a]!==e[a]){s=!1;break}s=!0}if(s===!0)return o}return null},e.prototype.sortBy=function(t,e){1===arguments.length&&(e=t,t=null);var n,r=i(t,this.properties);return r.sort(function(t,r){n=-1;for(var s in e)if(e.hasOwnProperty(s)){if(n=(i(s,t)+"").localeCompare(i(s,r)+""),0===n)continue;-1===e[s]&&(n=n>0?-1:1);break}return n}),this.set(t,r),r},e.prototype.validate=function(e,i){var r=[];return i=i||this.schema,i&&Object.keys(i).forEach(function(s){if(console.log("KEY:",s,typeof e[s],typeof i[s].type),"object"==typeof e[s]&&i[s].type===t){var o=this.validate(n.extend({},e[s]),n.extend({},i[s]));return Array.isArray(o)&&o.length>0&&(r=r.concat(o)),t}var a=this.validateOne(i[s],e[s]);a.isValid===!0?e[s]=a.value:(a.error.property=s,r.push(a.error))}.bind(this)),0===r.length?(this._isValid=!0,null):(this._isValid=!1,r)},e.prototype.validateOne=function(e,n){console.log("SCHEMA:",e);var i=null,r="function"==typeof e.type?typeof e.type():e.type.toLowerCase();if(""===n&&e.noEmpty===!0&&(n=t),n!==t&&null!==n||!e.default||(n=e.default),n===t||null===n||""===n)e.required===!0&&(i={msg:"Property is undefined or null, but it's required",errCode:10});else if("string"===r)e.convert&&"number"==typeof n&&(n+=""),r!==typeof n?i={msg:"Property type is a "+typeof n+", but a string is required",errCode:11}:e.min&&e.min>n.length?i={msg:"String length is too short",errCode:12}:e.max&&e.max<n.length?i={msg:"String length is too long",errCode:13}:e.match&&!e.match.test(n)&&(i={msg:"String doesn't match regexp",errCode:14});else if("number"===r)e.convert&&"string"==typeof n&&(n=parseInt(n,10)),r!==typeof n?i={msg:"Property type is a "+typeof n+", but a number is required",errCode:21}:e.min&&e.min>n?i={msg:"Number is too low",errCode:22}:e.max&&n>e.max&&(i={msg:"Number is too high",errCode:23});else if("date"===r){if(n){var s=Date.parse(n);isNaN(s)&&(i={msg:"Property isn't a valid date",errCode:31})}}else"array"===r?Array.isArray(n)?e.min&&e.min>n.length?i={msg:"Array length is "+n.length+" but must be greater than "+e.min,errCode:42}:e.max&&e.max<n.length&&(i={msg:"Array length is "+n.length+" but must be lesser than "+e.max,errCode:43}):i={msg:"Property type is a "+typeof n+", but an array is required",errCode:41}:"object"===r?"object"!=typeof n&&(i={msg:"Property isn't a valid object",errCode:51}):"objectid"===r?/^[a-zA-Z0-9]{24}$/.test(n)||(i={msg:"Property isn't a valid objectId",errCode:52}):"boolean"===r&&"boolean"!=typeof n&&(i={msg:"Property isn't a valid boolean",errCode:61});return null===i?i={isValid:!0,value:n,error:null}:(this.warn("Validation error on property",i,"Data:",n),i={isValid:!1,value:n,error:i}),i},e.prototype.isValid=function(){return this._isValid},e}(),n.Presenter=function(){"use strict";var t=function(t){this.root="/",this.debug=!1,this.routes=[],t=t||{},this.customInit=t.init,this.conf=t,delete t.init,n.extend(this,t,new n.Event,new n.Logger),this.name=(t.name||"Nameless")+"Presenter",this.eventCallbacks={},this.lastShownView=null,this.registeredViews=[],this.registeredModels=[],this.fireViewInit=function(t){var e=!0;this.registeredViews.forEach(function(n){t===n.view&&(n.isReady=!0),n.isReady===!1&&(e=!1)}),this.viewInit(t),e===!0&&this.emit("views.ready")},this.registerView=function(t){var e;if(t instanceof Array)for(e=0;t.length>e;e++)this.registeredViews.push({view:t[e],isReady:!1});else this.registeredViews.push({view:t,isReady:!1})},this.registerModel=function(t){var e;if(t instanceof Array)for(e=0;t.length>e;e++)this.registeredModels.push({model:t[e],isReady:!1});else this.registeredModels.push({model:t,isReady:!1})}};return t.prototype.events={},t.prototype.init=function(t){var e,i=this,r=this.conf;if(r.routes&&(this.Router=new n.Router,Object.keys(r.routes).forEach(function(t){var e=this.routes[t];"string"==typeof e&&(e=this[e]),"function"==typeof e?this.Router.addRoute(t,e):this.warn("Router callback isn't a function",e,"of route",t)}.bind(this)),window.addEventListener("popstate",function(t){i.__onPopstate(t.state)},!1),this.on("views.ready",function(){var t=n.defaultRoute;if(/^#![a-zA-Z0-9]+/.test(i.getHash())&&(t=i.getHash().substr(2)),t=i.Router.match(t)){var e=t.params;n.callerEvent&&(e[n.callerEvent]="pageload"),i.log("Trigger route",t,e),t.fn.call(i,t.params)}})),"function"==typeof this.customInit&&this.customInit.call(this),console.log("views",t),t instanceof Array)for(e=0;t.length>e;e++)this.registerView(t[e]);else t&&this.registerView(t);this.registeredViews.forEach(function(t){t.view.init(i)}),this.registeredModels.forEach(function(t){t.model.init(i)})},t.prototype.viewInit=function(){},t.prototype.pushState=function(t,e){var i=n.html5Routes||"/"===e.charAt(0)?"":n.hashBang;e=i+e,history.pushState(t,"",e||null),this.log("Update history with pushState",t,e)},t.prototype.replaceState=function(t,e){var i=n.html5Routes||"/"===e.charAt(0)?"":n.hashBang;e=i+e,history.replaceState(t,"",e||null),this.log("Update history with replaceState",t,e)},t.prototype.navigateTo=function(t,e,n){this.log("Navigate to route: ",t,e,n),n?this.replaceState(e,t):this.pushState(e,t),this.__onPopstate(e)},t.prototype.getView=function(t){var e,n;for(e=0;this.registeredViews.length>e;e++)if(n=this.registeredViews[e].view,n.name===t)return n;return null},t.prototype.showView=function(t,e){var n=this.getView(t+"View");return n?(this.log("Show view:",t,e),this.log("Hide view:",this.lastShownView),this.lastShownView!==n&&(this.lastShownView&&"function"==typeof this.lastShownView.hide?(this.lastShownView.hide(),n.show()):n.show(!0)),undefined):(this.warn("View not defined!",t),undefined)},t.prototype.getHash=function(){return location.hash},t.prototype.getPathname=function(){return location.pathname},t.prototype.couple=function(t){var e=t.view,i=t.model;return!e instanceof n.View?(this.error("Can't couple view with model! View isn't a XQCore.View"),undefined):!i instanceof n.Model?(this.error("Can't couple model with model! Model isn't a XQCore.Model"),undefined):(this.log("Couple view ",e.name,"with model",i.name),e.__coupledWith||(e.__coupledWith=[]),i.__coupledWith||(i.__coupledWith=[]),e.__coupledWith.some(function(t){return t===i})||e.__coupledWith.push(i),i.__coupledWith.some(function(t){return t===e})||i.__coupledWith.push(e),i.on("validation.error",function(t){i.__coupledWith.forEach(function(e){e.validationFailed(t)})}),i.on("data.change",function(t){i.__coupledWith.forEach(function(e){e.render(t)})}),this)},t.prototype.triggerEvent=function(t,e,n,i,r){this.events[e]?this.events[e].call(this,n,i,r):(n.preventDefault(),n.stopPropagation(),t.__coupledWith.forEach(function(t){"function"==typeof t[e]?(this.log("Autotrigger to model ",t.name," - ",e,r),t[e](r)):this.warn("Autotrigger to model failed! Function doesn't exists:",e,r)}))},t.prototype.__onPopstate=function(t){var e=this;e.log("popstate event recived",t);var i=n.defaultRoute;if(n.html5Routes){var r=RegExp("^"+e.root);i=e.getPathname().replace(r,"")}else/^#![a-zA-Z0-9]+/.test(this.getHash())&&(i=e.getHash().substr(2));i=e.Router.match(i),i&&(t=t||i.params,n.callerEvent&&(t[n.callerEvent]="popstate"),e.log("Trigger route",i,t),i.fn.call(e,t))},t}(),n.Model=function(t,e,i,r){var s;return s=function(t){t===r&&(t={}),this.customInit=t.init,delete t.init,this.customValidate=t.validate,delete t.validate,this.conf=t,i.extend(this,t,new n.Logger),i.extend(this,new n.Event),this.name=(t.name||"Nameless")+"Model",this.debug=Boolean(t.debug),this.properties={},this.defaults&&!i.isEmptyObject(this.defaults)&&this.set(this.defaults)},i.extend(s.prototype,new n.GetSet),s.prototype.init=function(){this.debug&&(n._dump[this.name]=this),"function"==typeof this.customInit&&this.customInit.call(this)},s.prototype.onSend=function(t){return t},s.prototype.send=function(t,e,n,s){"object"==typeof e?(s=n,n=e,e=this.server,t=t):"function"==typeof n?(s=n,n=this.get()):n===r&&(n=this.get()),t===r&&(t="POST"),e||(e=this.server),"function"==typeof this.onSend&&(n=this.onSend.call(this,n)),this.log("Sending an ajax call to ",this.server,"with data: ",n),i.ajax({url:e,type:t,data:n,dataType:"json",success:function(t,e,n){"function"==typeof s&&s.call(this,null,t,e,n)}.bind(this),error:function(t,e,n){"function"==typeof s&&s.call(this,{type:e,http:n},null,e,t)}.bind(this)})},s.prototype.sendPOST=function(t,e,n){this.send("POST",t,e,n)},s.prototype.sendGET=function(t,e,n){this.send("GET",t,e,n)},s.prototype.sendPUT=function(t,e,n){this.send("PUT",t,e,n)},s.prototype.sendDELETE=function(t,e,n){this.send("DELETE",t,e,n)},s.prototype.ready=function(t){t===!0?(Array.isArray(this.__callbacksOnReady)&&(this.log("Trigger ready state"),this.__callbacksOnReady.forEach(function(t){t.call(this)}.bind(this))),this.__isReady=!0,delete this.__callbacksOnReady):"function"==typeof t?this.__isReady===!0?t():(this.__callbacksOnReady||(this.__callbacksOnReady=[]),this.__callbacksOnReady.push(t)):this.warn("arg0 isn't a callback in model.ready()!")},s.prototype.fetch=function(t,e){this.sendGET(t,e)},s.fetch=function(t){this.sendGET(t,function(t,e){t&&console.error(t),e=this.prepare(e),this.set(e)}.bind(this))},s}(window,document,t),n.View=function(t){"use strict";var i=function(t){2===arguments.length&&(this.presenter=arguments[0],t=arguments[1],console.warn("Defining View with presenter is deprecated.")),t=t||{events:null},this.customInit=t.init,this.conf=t,delete t.init,n.extend(this,t,new n.Event,new n.Logger),this.name=(t.name||"Nameless")+"View",this.debug=Boolean(t.debug)};i.prototype.init=function(t){var e=this,i=this.conf;this.presenter=t,$(function(){this.container=$(i.container),i.tag?(this.$el=$($.parseHTML("<"+i.tag+"/>")),this.$el.appendTo(this.container)):this.$el=this.container,this.el=this.$el.get(0),i.hidden===!0&&this.$el.hide(),i.id&&this.$el.attr("id",i.id),i.className&&this.$el.addClass(i.className),this.container.length>0?(window.addEventListener("resize",function(t){e.resize(t)},!1),this.log("Initialize view with conf:",i),this.log("  ... using Presenter:",this.presenter.name),this.log("  ... using Container:",this.container),this.events&&Object.keys(this.events).forEach(function(t){var e,i=t.indexOf(" "),s=this.events[t],o=t.substr(0,i),a=t.substr(i+1)||this.container,l=this;if("function"==typeof s)e=this;else if(0===s.indexOf("view:"))s=this[s.substr(5)],e=this;else if("function"==typeof this.presenter.events[this.events[t]])s=this.presenter.events[this.events[t]],e=this.presenter;else{var h=s;s=function(t,e,n){this.triggerEvent(h,t,e,n)}.bind(this),e=this}s&&o?"function"==typeof s?(this.container.delegate(a,o,function(t){var i=null,o=null;"submit"===t.type?i=n.Util.serializeForm(t.currentTarget):("keydown"===t.type||"keyup"===t.type||"keypress"===t.type)&&(i=$(t.currentTarget).val()),o=$.extend($(t.currentTarget).data(),{itemIndex:r.call(l,t.currentTarget)}),s.call(e,t,o,i)}.bind(this)),this.log("Register Event:",o,"on selector",a,"with callback",s)):this.warn("Event handler callback not defined in Presenter:",this.events[t]):this.warn("Incorect event configuration",t)},this),"function"==typeof this.customInit&&this.customInit.call(this),this.presenter.fireViewInit(this)):this.error("Can't initialize View, Container not found!",this.container)}.bind(this))},i.prototype.show=function(){this.$el.show()},i.prototype.hide=function(){this.$el.hide()},i.prototype.render=function(t){this.log("Render view template",this.template,"with data:",t);var n="function"==typeof this.template?this.template:e.compile(this.template);this.$el.html(n(t||{})),this.emit("content.change",t)},i.prototype.renderHTML=function(t,n){return this.log("Render view html snipet",t,"with data:",n),t="function"==typeof t?t:e.compile(t),t(n)},i.prototype.resize=function(){},i.prototype.append=function(t,e){this.manipulate("append",t,e)},i.prototype.prepend=function(t,e){this.manipulate("prepend",t,e)},i.prototype.remove=function(t){this.manipulate("remove",t)},i.prototype.manipulate=function(n,i){if(this.subSelector===t)return this.warn("You must set the subSelector option"),!1;if(this.itemTemplate===t)return this.warn("You must set the itemTemplate option"),!1;var r,s=$(this.subSelector,this.container);switch(n){case"append":r=e.compile(this.itemTemplate)(i),$(r).appendTo(s);break;case"prepend":r=e.compile(this.itemTemplate)(i),$(r).prependTo(s);break;case"remove":s.children().eq(i).remove();break;default:this.error("undefined action in view.manipulate()",n)}},i.prototype.getElementData=function(e){var n=$(e,this.container);if(n.length){var i,r={},s=n.get(0).attributes;for(i=0;s.length>i;i++)if(0===s[i].name.indexOf("data-")){var o=s[i].name.substr(5),a=s[i].value;if("string"==typeof a)try{a="true"===a||"TRUE"===a?!0:"false"===a||"FALSE"===a?!1:"null"===a||"NULL"===a?null:"undefined"===a?t:+a+""===a?+a:JSON.parse(a)}catch(l){}r[o]=a}return r}return null},i.prototype.triggerEvent=function(t,e,n,i){this.presenter.events[t]?this.presenter.events[t].call(this.presenter,e,n,i):(e.preventDefault(),e.stopPropagation(),this.__coupledWith&&this.__coupledWith.forEach(function(e){"function"==typeof e[t]?(this.log("Autotrigger to model:",t,i),e[t](i)):this.warn("Autotrigger to model failed! Function doesn't exists:",t,i)}.bind(this)))},i.prototype.navigateTo=function(t,e,n){this.presenter.navigateTo(t,e,n)},i.prototype.validationFailed=function(){};var r=function(t){var e=null,n=$(this.container).get(0),i=$(t),r=i.parent(),s=$(this.subSelector).get(0),o=0;if(this.subSelector)do{if(r.get(0)===s)return $(i).index();if(i=i.parent(),r=i.parent(),++o>100){console.error("Break loop!");break}}while(i.length&&i.get(0)!==n);return e};return i}(),n.Util=function(t){"use strict";var e={name:"XQCore.Util",debug:!0};return e.serializeForm=function(e){var n={},i=t(e);return"INPUT"!==i.get(0).tagName&&(i=i.find(":input")),i.serializeArray().forEach(function(t){n[t.name]=t.value}),this.debug&&console.log("XQCore - Serialize form:",i,n),n},e.checkLength=function(t,e,n){if("Number"==typeof t){if(e>t)return"num-to-small";if(t>n)return"num-to-large"}else{if(console.log(t,t.length),e>t.length)return"str-to-short";if(t.length>n)return"str-to-long"}},e.checkEqual=function(t,e){return t!==e?"str-not-equal":void 0},e.checkEmail=function(t){return/^\S+\@\S+\.[a-z]{2,10}$/.test(t)?void 0:"invalid-email"},e.checkUrl=function(t){return/^http(s)?:\/\/\S\.[a-zA-Z]{2,10}\/?$/.test(t)?void 0:"invalid-url"},e}(t),n.Router=function(){"use strict";var t=function(t){var n,i,r=[];return t instanceof RegExp?(i=t,n=""+t):(i=e(t,r),n=t),{re:i,src:""+t,keys:r}},e=function(t,e){return t=t.concat("/?").replace(/\/\(/g,"(?:/").replace(/(\/)?(\.)?:(\w+)(?:(\(.*?\)))?(\?)?/g,function(t,n,i,r,s,o){return e.push(r),n=n||"",""+(o?"":n)+"(?:"+(o?n:"")+(i||"")+(s||"([^/]+?)")+")"+(o||"")}).replace(/([\/.])/g,"\\$1").replace(/\*/g,"(.+)"),RegExp("^"+t+"$","i")},i=function(t,e){for(var n,i=0,r=t.length;r>i;++i){var s,o=t[i],a=o.re,l=o.keys,h=[],u={};if(n=a.exec(e)){for(s=1,r=n.length;r>s;++s){var c=l[s-1],p="string"==typeof n[s]?decodeURIComponent(n[s]):n[s];c?u[c]=p:h.push(p)}return{params:u,splats:h,route:o.src}}}},r=function(t){t=n.extend({debug:!1},t),this.debug=Boolean(t.debug),this.routes=[],this.routeMap={}};return r.prototype.addRoute=function(e,n){if(!e)throw Error(" route requires a path");if(!n)throw Error(" route "+(""+e)+" requires a callback");var i=new t(e);i.fn=n,this.routes.push(i),this.routeMap[e]=n},r.prototype.match=function(t){var e=i(this.routes,t);return e&&(e.fn=this.routeMap[e.route]),e},r.prototype.fire=function(t,e){t=this.match(t),t&&t.fn(e)},r}(),function(t,e){var n,i=function(){return"transition"in document.body.style?"transition":"MozTransition"in document.body.style?"MozTransition":"WebkitTransition"in document.body.style?"WebkitTransition":"OTransition"in document.body.style?"OTransition":"MsTransition"in document.body.style?"MsTransition":e};t.slideIn=function(t){if(t=$.extend({parent:this.el.parentNode,transition:"left .75s",direction:"auto"},t),n===e&&(n=i()),t.parent&&this.el){this.log("> slide plugin > Slide view",this.el,"in container",t.parent);var r=t.parent.offsetWidth;this.el.style.display="block",this.el.style[n]="none",this.el.style.left=r+"px",window.setTimeout(function(){this.el.style[n]=t.transition,this.el.style.left="0"}.bind(this))}else this.warn("> slide plugin > Can't slide view! View or parent not found! View",this.el,"in container",t.parent)},t.slideOut=function(t){if(t=$.extend({parent:this.el.parentNode,transition:"left .75s",direction:"auto"},t),n===e&&(n=i()),t.parent&&this.el){this.log("> slide plugin > Slide view",this.el,"in container",t.parent);var r=t.parent.offsetWidth;this.el.style[n]=t.transition,this.el.style.left=r+"px";var s=function(){+this.el.style.left.replace("px","")>=r&&(this.el.style.display="none",this.el.style[n]="none"),this.el.removeEventListener("transitionend",s)}.bind(this);this.el.addEventListener("transitionend",s)}else this.warn("> slide plugin > Can't slide view! View or parent not found! View",this.el,"in container",t.parent)}}(n.View.prototype),n});