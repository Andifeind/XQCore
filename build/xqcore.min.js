/*!
 * XQCore - 0.5.1
 * 
 * Model View Presenter Javascript Framework
 *
 * XQCore is licenced under MIT Licence
 * http://opensource.org/licenses/MIT
 *
 * Copyright (c) 2012 - 2013 Noname Media, http://noname-media.com
 * Author Andi Heinkelein
 *
 * Creation Date: 2013-12-06
 */
var XQCore;!function(a,b){"use strict";"function"==typeof define&&define.amd?define("xqcore",["jquery","handlebars"],b):"undefined"!=typeof module&&module.exports?module.exports=b(require("jquery"),require("handlebars")):a.XQCore=b(a.jQuery,a.Handlebars)}(this,function(a,b){"use strict";return XQCore={version:"0.5.1",defaultRoute:"default",html5Routes:!1,hashBang:"#!",callerEvent:"callerEvent"},XQCore.extend=a.extend,XQCore.isEmptyObject=a.isEmptyObject,XQCore._dump={},XQCore.dump=function(a){return XQCore._dump[a]?(console.log("[XQCore dump]",a,XQCore._dump[a]),XQCore._dump[a]):!1},XQCore.require=function(c){return"jquery"===c?a:"handlebars"===c?b:void 0},XQCore}),XQCore.Event=function(){"use strict";/*!
	 * EventEmitter v4.2.5 - git.io/ee
	 * Oliver Caldwell
	 * MIT license
	 * @preserve
	 */
function a(){}function b(a,b){for(var c=a.length;c--;)if(a[c].listener===b)return c;return-1}function c(a){return function(){return this[a].apply(this,arguments)}}var d=a.prototype;return d.getListeners=function(a){var b,c,d=this._getEvents();if("object"==typeof a){b={};for(c in d)d.hasOwnProperty(c)&&a.test(c)&&(b[c]=d[c])}else b=d[a]||(d[a]=[]);return b},d.flattenListeners=function(a){var b,c=[];for(b=0;b<a.length;b+=1)c.push(a[b].listener);return c},d.getListenersAsObject=function(a){var b,c=this.getListeners(a);return c instanceof Array&&(b={},b[a]=c),b||c},d.addListener=function(a,c){var d,e=this.getListenersAsObject(a),f="object"==typeof c;for(d in e)e.hasOwnProperty(d)&&-1===b(e[d],c)&&e[d].push(f?c:{listener:c,once:!1});return this},d.on=c("addListener"),d.addOnceListener=function(a,b){return this.addListener(a,{listener:b,once:!0})},d.once=c("addOnceListener"),d.defineEvent=function(a){return this.getListeners(a),this},d.defineEvents=function(a){for(var b=0;b<a.length;b+=1)this.defineEvent(a[b]);return this},d.removeListener=function(a,c){var d,e,f=this.getListenersAsObject(a);for(e in f)f.hasOwnProperty(e)&&(d=b(f[e],c),-1!==d&&f[e].splice(d,1));return this},d.off=c("removeListener"),d.addListeners=function(a,b){return this.manipulateListeners(!1,a,b)},d.removeListeners=function(a,b){return this.manipulateListeners(!0,a,b)},d.manipulateListeners=function(a,b,c){var d,e,f=a?this.removeListener:this.addListener,g=a?this.removeListeners:this.addListeners;if("object"!=typeof b||b instanceof RegExp)for(d=c.length;d--;)f.call(this,b,c[d]);else for(d in b)b.hasOwnProperty(d)&&(e=b[d])&&("function"==typeof e?f.call(this,d,e):g.call(this,d,e));return this},d.removeEvent=function(a){var b,c=typeof a,d=this._getEvents();if("string"===c)delete d[a];else if("object"===c)for(b in d)d.hasOwnProperty(b)&&a.test(b)&&delete d[b];else delete this._events;return this},d.removeAllListeners=c("removeEvent"),d.emitEvent=function(a,b){var c,d,e,f,g=this.getListenersAsObject(a);for(e in g)if(g.hasOwnProperty(e))for(d=g[e].length;d--;)c=g[e][d],c.once===!0&&this.removeListener(a,c.listener),f=c.listener.apply(this,b||[]),f===this._getOnceReturnValue()&&this.removeListener(a,c.listener);return this},d.trigger=c("emitEvent"),d.emit=function(a){var b=Array.prototype.slice.call(arguments,1);return this.emitEvent(a,b)},d.setOnceReturnValue=function(a){return this._onceReturnValue=a,this},d._getOnceReturnValue=function(){return this.hasOwnProperty("_onceReturnValue")?this._onceReturnValue:!0},d._getEvents=function(){return this._events||(this._events={})},a}(),XQCore.Logger=function(){"use strict";function a(a){return 1e3>a?a+" ms":6e4>a?Math.round(a/100)/10+" sec":Math.round(a/6e4)+" min "+Math.round(a%6e4/1e3)+" sec"}var b=function(){};return b.prototype.log=function(){var a;this.debug&&(a=Array.prototype.slice.call(arguments),a.unshift("["+this.name+"]"),console.log.apply(console,a))},b.prototype.warn=function(){var a;this.debug&&(a=Array.prototype.slice.call(arguments),a.unshift("["+this.name+"]"),console.warn.apply(console,a))},b.prototype.error=function(){var a;this.debug&&(a=Array.prototype.slice.call(arguments),a.unshift("["+this.name+"]"),console.error.apply(console,a))},b.prototype.timer=function(b){var c={start:null,stop:null,name:b,logger:this,end:function(){this.stop=Date.now(),this.logger.log("Timer "+this.name+" runs: ",a(this.stop-this.start))}};return this.log("Start Timer",b),c.start=Date.now(),c},b.prototype.__scope={getHumanTime:a},b}(),XQCore.Presenter=function(){"use strict";var a=function(a){this.root="/",this.debug=!1,this.routes=[],a=a||{},this.customInit=a.init,this.conf=a,delete a.init,XQCore.extend(this,a,new XQCore.Event,new XQCore.Logger),this.name=(a.name||"Nameless")+"Presenter",this.eventCallbacks={},this.lastShownView=null,this.registeredViews=[],this.registeredModels=[],this.fireViewInit=function(a){var b=!0;this.registeredViews.forEach(function(c){a===c.view&&(c.isReady=!0),c.isReady===!1&&(b=!1)}),this.viewInit(a),b===!0&&this.emit("views.ready")},this.registerView=function(a){var b;if(a instanceof Array)for(b=0;b<a.length;b++)this.registeredViews.push({view:a[b],isReady:!1});else this.registeredViews.push({view:a,isReady:!1})},this.registerModel=function(a){var b;if(a instanceof Array)for(b=0;b<a.length;b++)this.registeredModels.push({model:a[b],isReady:!1});else this.registeredModels.push({model:a,isReady:!1})}};return a.prototype.events={},a.prototype.init=function(a){var b,c=this,d=this.conf;if(d.routes&&(this.Router=new XQCore.Router,Object.keys(d.routes).forEach(function(a){var b=this.routes[a];"string"==typeof b&&(b=this[b]),"function"==typeof b?this.Router.addRoute(a,b):this.warn("Router callback isn't a function",b,"of route",a)}.bind(this)),window.addEventListener("popstate",function(a){c.__onPopstate(a.state)},!1),this.on("views.ready",function(){var a=XQCore.defaultRoute;if(/^#![a-zA-Z0-9]+/.test(c.getHash())&&(a=c.getHash().substr(2)),a=c.Router.match(a)){var b=a.params;XQCore.callerEvent&&(b[XQCore.callerEvent]="pageload"),c.log("Trigger route",a,b),a.fn.call(c,a.params)}})),"function"==typeof this.customInit&&this.customInit.call(this),console.log("views",a),a instanceof Array)for(b=0;b<a.length;b++)this.registerView(a[b]);else a&&this.registerView(a);this.registeredViews.forEach(function(a){a.view.init(c)}),this.registeredModels.forEach(function(a){a.model.init(c)})},a.prototype.viewInit=function(){},a.prototype.pushState=function(a,b){var c=XQCore.html5Routes||"/"===b.charAt(0)?"":XQCore.hashBang;b=c+b,history.pushState(a,"",b||null),this.log("Update history with pushState",a,b)},a.prototype.replaceState=function(a,b){var c=XQCore.html5Routes||"/"===b.charAt(0)?"":XQCore.hashBang;b=c+b,history.replaceState(a,"",b||null),this.log("Update history with replaceState",a,b)},a.prototype.navigateTo=function(a,b,c){this.log("Navigate to route: ",a,b,c),c?this.replaceState(b,a):this.pushState(b,a),this.__onPopstate(b)},a.prototype.getView=function(a){var b,c;for(b=0;b<this.registeredViews.length;b++)if(c=this.registeredViews[b].view,c.name===a)return c;return null},a.prototype.showView=function(a,b){var c=this.getView(a+"View");return c?(this.log("Show view:",a,b),this.log("Hide view:",this.lastShownView),this.lastShownView!==c&&(this.lastShownView&&"function"==typeof this.lastShownView.hide?(this.lastShownView.hide(),c.show()):c.show(!0)),void 0):(this.warn("View not defined!",a),void 0)},a.prototype.getHash=function(){return location.hash},a.prototype.getPathname=function(){return location.pathname},a.prototype.couple=function(a){var b=a.view,c=a.model;return!b instanceof XQCore.View?(this.error("Can't couple view with model! View isn't a XQCore.View"),void 0):!c instanceof XQCore.Model?(this.error("Can't couple model with model! Model isn't a XQCore.Model"),void 0):(this.log("Couple view ",b.name,"with model",c.name),b.__coupledWith||(b.__coupledWith=[]),c.__coupledWith||(c.__coupledWith=[]),b.__coupledWith.some(function(a){return a===c})||b.__coupledWith.push(c),c.__coupledWith.some(function(a){return a===b})||c.__coupledWith.push(b),c.on("validation.error",function(a){c.__coupledWith.forEach(function(b){b.validationFailed(a)})}),c.on("data.change",function(a){c.__coupledWith.forEach(function(b){b.render(a)})}),this)},a.prototype.triggerEvent=function(a,b,c,d,e){this.events[b]?this.events[b].call(this,c,d,e):(c.preventDefault(),c.stopPropagation(),a.__coupledWith.forEach(function(a){"function"==typeof a[b]?(this.log("Autotrigger to model ",a.name," - ",b,e),a[b](e)):this.warn("Autotrigger to model failed! Function doesn't exists:",b,e)}))},a.prototype.__onPopstate=function(a){var b=this;b.log("popstate event recived",a);var c=XQCore.defaultRoute;if(XQCore.html5Routes){var d=new RegExp("^"+b.root);c=b.getPathname().replace(d,"")}else/^#![a-zA-Z0-9]+/.test(this.getHash())&&(c=b.getHash().substr(2));c=b.Router.match(c),c&&(a=a||c.params,XQCore.callerEvent&&(a[XQCore.callerEvent]="popstate"),b.log("Trigger route",c,a),c.fn.call(b,a))},a}(),function(a,b){"use strict";var c=function(){};c.prototype.onSend=function(a){return a},c.prototype.send=function(a,c,d,e){"object"==typeof c?(e=d,d=c,c=this.server,a=a):"function"==typeof d?(e=d,d=this.get()):void 0===d&&(d=this.get()),void 0===a&&(a="POST"),c||(c=this.server),"function"==typeof this.onSend&&(d=this.onSend.call(this,d)),this.log("Sending an ajax call to ",this.server,"with data: ",d),this.state("syncing"),b.ajax({url:c,type:a,data:d,dataType:"json",success:function(a,b,c){"function"==typeof e&&(this.state("success"),e.call(this,null,a,b,c))}.bind(this),error:function(a,b,c){"function"==typeof e&&(this.state("failed"),e.call(this,{type:b,http:c},null,b,a))}.bind(this)})},c.prototype.sendPOST=function(a,b,c){this.send("POST",a,b,c)},c.prototype.sendGET=function(a,b,c){this.send("GET",a,b,c)},c.prototype.sendPUT=function(a,b,c){this.send("PUT",a,b,c)},c.prototype.sendDELETE=function(a,b,c){this.send("DELETE",a,b,c)},c.prototype.ready=function(a){a===!0?(Array.isArray(this.__callbacksOnReady)&&(this.log("Trigger ready state"),this.__callbacksOnReady.forEach(function(a){a.call(this)}.bind(this))),this.__isReady=!0,delete this.__callbacksOnReady):"function"==typeof a?this.__isReady===!0?a():(this.__callbacksOnReady||(this.__callbacksOnReady=[]),this.__callbacksOnReady.push(a)):this.warn("arg0 isn't a callback in model.ready()!")},c.prototype.fetch=function(a,b){this.sendGET(a,b)},a.Sync=c}(XQCore,jQuery),function(a,b){"use strict";var c,d=function(a,b){return a&&(a=a.split("."),a.forEach(function(a){b=b[a]})),b};c=function(c){c===b&&(c={}),this.__state="starting",this.customInit=c.init,delete c.init,this.customValidate=c.validate,delete c.validate,this.conf=c,a.extend(this,c,new a.Logger),a.extend(this,new a.Event),this.name=(c.name||"Nameless")+"Model",this.debug=Boolean(c.debug),this._isValid=!1,this.properties={},this.schema=c.schema,this.defaults&&!a.isEmptyObject(this.defaults)&&this.set(this.defaults)},a.Sync&&a.extend(c.prototype,a.Sync.prototype),c.prototype.init=function(){this.debug&&(a._dump[this.name]=this),"function"==typeof this.customInit&&this.customInit.call(this),this.state("ready")},c.prototype.state=function(a){this.__state=a,this.emit("state."+a)},c.prototype.getState=function(){return this.__state},c.prototype.set=function(){var a,b,c={},d=this.get();if(null===arguments[0])c=arguments[1],this.log("Set data",c,d);else if("object"==typeof arguments[0])c=arguments[0],this.log("Set data",c,d);else if("string"==typeof arguments[0]){c=this.get(),b=arguments[0];var e=arguments[1];c[b]=e,this.log("Set data",c,d)}else this.warn("Data are incorrect in model.set()",arguments);return this.schema&&(a=this.validate(c),null!==a)?(this.warn("Validate error in model.set",a),this.emit("validation.error",a),!1):this.customValidate&&(a=this.customValidate(c),null!==a)?(this.warn("Validate error in model.set",a),this.emit("validation.error",a),!1):(this.properties=c,this.emit("data.change",c,d),b&&this.emit("change."+b,c[b]),!0)},c.prototype.get=function(a){return a===b?this.properties:this.properties[a]},c.prototype.has=function(a){return!!this.properties[a]},c.prototype.reset=function(){this.log("Reset model"),this.properties={},this.removeAllListener()},c.prototype.append=function(a,b){1===arguments.length&&(b=a,a=null);var c=this.properties,d=this.get(),e=!0;return a&&a.split(".").forEach(function(a){c=c[a]}),c instanceof Array?c.push(b):null===a?(this.properties=[b],c=this.get()):this.warn("Model.append requires an array. Dataset isn't an array",a),e&&this.emit("data.change",c,d),b},c.prototype.prepend=function(a,b){1===arguments.length&&(b=a,a=null);var c=this.properties,d=this.get(),e=!0;return a&&a.split(".").forEach(function(a){c=c[a]}),c instanceof Array?c.unshift(b):null===a?(this.properties=[b],c=this.get()):this.warn("Model.append requires an array. Dataset isn't an array",a),e&&this.emit("data.change",c,d),b},c.prototype.remove=function(a,b){var c=this.properties,d=null;return a.split(".").forEach(function(a){c=c[a]}),c instanceof Array?(d=c.splice(b,1),d=d[0]||null):this.warn("Model.remove() doesn't work with Objects in model",this.name),d},c.prototype.search=function(a,b){var c=d(a,this.properties);if(c)for(var e=0;e<c.length;e++){var f,g=c[e];for(var h in b)if(b.hasOwnProperty(h)){if(!g[h]||g[h]!==b[h]){f=!1;break}f=!0}if(f===!0)return g}return null},c.prototype.sortBy=function(a,b){1===arguments.length&&(b=a,a=null);var c,e=d(a,this.properties);return e.sort(function(a,e){c=-1;for(var f in b)if(b.hasOwnProperty(f)){if(c=String(d(f,a)).localeCompare(String(d(f,e))),0===c)continue;-1===b[f]&&(c=c>0?-1:1);break}return c}),this.set(a,e),e},c.prototype.validate=function(b,c){var d=[];return c=c||this.schema,c&&Object.keys(c).forEach(function(e){if("object"==typeof b[e]&&"undefined"==typeof c[e].type){var f=this.validate(a.extend({},b[e]),a.extend({},c[e]));return Array.isArray(f)&&f.length>0&&(d=d.concat(f)),void 0}var g=this.validateOne(c[e],b[e]);g.isValid===!0?b[e]=g.value:(g.error.property=e,d.push(g.error))}.bind(this)),0===d.length?(this._isValid=!0,null):(this._isValid=!1,d)},c.prototype.validateOne=function(a,c){var d=null,e="function"==typeof a.type?typeof a.type():a.type.toLowerCase();if(""===c&&a.noEmpty===!0&&(c=b),c!==b&&null!==c||!a.default||(c=a.default),c===b||null===c||""===c)a.required===!0&&(d={msg:"Property is undefined or null, but it's required",errCode:10});else if("string"===e)a.convert&&"number"==typeof c&&(c=String(c)),e!==typeof c?d={msg:"Property type is a "+typeof c+", but a string is required",errCode:11}:a.min&&a.min>c.length?d={msg:"String length is too short",errCode:12}:a.max&&a.max<c.length?d={msg:"String length is too long",errCode:13}:a.match&&!a.match.test(c)&&(d={msg:"String doesn't match regexp",errCode:14});else if("number"===e)a.convert&&"string"==typeof c&&(c=parseInt(c,10)),e!==typeof c?d={msg:"Property type is a "+typeof c+", but a number is required",errCode:21}:a.min&&a.min>c?d={msg:"Number is too low",errCode:22}:a.max&&a.max<c&&(d={msg:"Number is too high",errCode:23});else if("date"===e){if(c){var f=Date.parse(c);isNaN(f)&&(d={msg:"Property isn't a valid date",errCode:31})}}else"array"===e?Array.isArray(c)?a.min&&a.min>c.length?d={msg:"Array length is "+c.length+" but must be greater than "+a.min,errCode:42}:a.max&&a.max<c.length&&(d={msg:"Array length is "+c.length+" but must be lesser than "+a.max,errCode:43}):d={msg:"Property type is a "+typeof c+", but an array is required",errCode:41}:"object"===e?"object"!=typeof c&&(d={msg:"Property isn't a valid object",errCode:51}):"objectid"===e?/^[a-zA-Z0-9]{24}$/.test(c)||(d={msg:"Property isn't a valid objectId",errCode:52}):"boolean"===e&&"boolean"!=typeof c&&(d={msg:"Property isn't a valid boolean",errCode:61});return null===d?d={isValid:!0,value:c,error:null}:(this.warn("Validation error on property",d,"Data:",c),d={isValid:!1,value:c,error:d}),d},c.prototype.isValid=function(){return this._isValid},a.Model=c}(this.XQCore),XQCore.View=function(a){"use strict";var b=function(a){2===arguments.length&&(this.presenter=arguments[0],a=arguments[1],console.warn("Defining View with presenter is deprecated.")),a=a||{events:null},this.customInit=a.init,this.conf=a,delete a.init,XQCore.extend(this,a,new XQCore.Event,new XQCore.Logger),this.name=(a.name||"Nameless")+"View",this.debug=Boolean(a.debug)};b.prototype.init=function(a){var b=this,d=this.conf;this.presenter=a,$(function(){this.container=$(d.container),d.tag?(this.$el=$($.parseHTML("<"+d.tag+"/>")),this.$el.appendTo(this.container)):this.$el=this.container,this.el=this.$el.get(0),d.hidden===!0&&this.$el.hide(),d.id&&this.$el.attr("id",d.id),d.className&&this.$el.addClass(d.className),this.container.length>0?(window.addEventListener("resize",function(a){b.resize(a)},!1),this.log("Initialize view with conf:",d),this.log("  ... using Presenter:",this.presenter.name),this.log("  ... using Container:",this.container),this.events&&Object.keys(this.events).forEach(function(a){var b,d=a.indexOf(" "),e=this.events[a],f=a.substr(0,d),g=a.substr(d+1)||this.container,h=this;if("function"==typeof e)b=this;else if(0===e.indexOf("view:"))e=this[e.substr(5)],b=this;else if("function"==typeof this.presenter.events[this.events[a]])e=this.presenter.events[this.events[a]],b=this.presenter;else{var i=e;e=function(a,b,c){this.triggerEvent(i,a,b,c)}.bind(this),b=this}e&&f?"function"==typeof e?(this.container.delegate(g,f,function(a){var d=null,f=null;"submit"===a.type?d=XQCore.Util.serializeForm(a.currentTarget):("keydown"===a.type||"keyup"===a.type||"keypress"===a.type)&&(d=$(a.currentTarget).val()),f=$.extend($(a.currentTarget).data(),{itemIndex:c.call(h,a.currentTarget)}),e.call(b,a,f,d)}.bind(this)),this.log("Register Event:",f,"on selector",g,"with callback",e)):this.warn("Event handler callback not defined in Presenter:",this.events[a]):this.warn("Incorect event configuration",a)},this),"function"==typeof this.customInit&&this.customInit.call(this),this.presenter.fireViewInit(this)):this.error("Can't initialize View, Container not found!",this.container)}.bind(this))},b.prototype.show=function(){this.$el.show()},b.prototype.hide=function(){this.$el.hide()},b.prototype.render=function(a){this.log("Render view template",this.template,"with data:",a);var b="function"==typeof this.template?this.template:Handlebars.compile(this.template);this.$el.html(b(a||{})),this.emit("content.change",a)},b.prototype.renderHTML=function(a,b){return this.log("Render view html snipet",a,"with data:",b),a="function"==typeof a?a:Handlebars.compile(a),a(b)},b.prototype.resize=function(){},b.prototype.append=function(a,b){this.manipulate("append",a,b)},b.prototype.prepend=function(a,b){this.manipulate("prepend",a,b)},b.prototype.remove=function(a){this.manipulate("remove",a)},b.prototype.manipulate=function(b,c){if(this.subSelector===a)return this.warn("You must set the subSelector option"),!1;if(this.itemTemplate===a)return this.warn("You must set the itemTemplate option"),!1;var d,e=$(this.subSelector,this.container);switch(b){case"append":d=Handlebars.compile(this.itemTemplate)(c),$(d).appendTo(e);break;case"prepend":d=Handlebars.compile(this.itemTemplate)(c),$(d).prependTo(e);break;case"remove":e.children().eq(c).remove();break;default:this.error("undefined action in view.manipulate()",b)}},b.prototype.getElementData=function(b){var c=$(b,this.container);if(c.length){var d,e={},f=c.get(0).attributes;for(d=0;d<f.length;d++)if(0===f[d].name.indexOf("data-")){var g=f[d].name.substr(5),h=f[d].value;if("string"==typeof h)try{h="true"===h||"TRUE"===h?!0:"false"===h||"FALSE"===h?!1:"null"===h||"NULL"===h?null:"undefined"===h?a:+h+""===h?+h:JSON.parse(h)}catch(i){}e[g]=h}return e}return null},b.prototype.triggerEvent=function(a,b,c,d){this.presenter.events[a]?this.presenter.events[a].call(this.presenter,b,c,d):(b.preventDefault(),b.stopPropagation(),this.__coupledWith&&this.__coupledWith.forEach(function(b){"function"==typeof b[a]?(this.log("Autotrigger to model:",a,d),b[a](d)):this.warn("Autotrigger to model failed! Function doesn't exists:",a,d)}.bind(this)))},b.prototype.navigateTo=function(a,b,c){this.presenter.navigateTo(a,b,c)},b.prototype.validationFailed=function(){};var c=function(a){var b=null,c=$(this.container).get(0),d=$(a),e=d.parent(),f=$(this.subSelector).get(0),g=0;if(this.subSelector)do{if(e.get(0)===f)return $(d).index();if(d=d.parent(),e=d.parent(),++g>100){console.error("Break loop!");break}}while(d.length&&d.get(0)!==c);return b};return b}(),XQCore.Util=function(a){"use strict";var b={name:"XQCore.Util",debug:!0};return b.serializeForm=function(b){var c={},d=a(b);return"INPUT"!==d.get(0).tagName&&(d=d.find(":input")),d.serializeArray().forEach(function(a){c[a.name]=a.value}),this.debug&&console.log("XQCore - Serialize form:",d,c),c},b.checkLength=function(a,b,c){if("Number"==typeof a){if(b>a)return"num-to-small";if(a>c)return"num-to-large"}else{if(console.log(a,a.length),a.length<b)return"str-to-short";if(a.length>c)return"str-to-long"}},b.checkEqual=function(a,b){return a!==b?"str-not-equal":void 0},b.checkEmail=function(a){return/^\S+\@\S+\.[a-z]{2,10}$/.test(a)?void 0:"invalid-email"},b.checkUrl=function(a){return/^http(s)?:\/\/\S\.[a-zA-Z]{2,10}\/?$/.test(a)?void 0:"invalid-url"},b}(jQuery),XQCore.Router=function(){"use strict";var a=function(a){var c,d,e=[];return a instanceof RegExp?(d=a,c=a.toString()):(d=b(a,e),c=a),{re:d,src:a.toString(),keys:e}},b=function(a,b){return a=a.concat("/?").replace(/\/\(/g,"(?:/").replace(/(\/)?(\.)?:(\w+)(?:(\(.*?\)))?(\?)?/g,function(a,c,d,e,f,g){return b.push(e),c=c||"",""+(g?"":c)+"(?:"+(g?c:"")+(d||"")+(f||"([^/]+?)")+")"+(g||"")}).replace(/([\/.])/g,"\\$1").replace(/\*/g,"(.+)"),new RegExp("^"+a+"$","i")},c=function(a,b){for(var c,d=0,e=a.length;e>d;++d){var f,g=a[d],h=g.re,i=g.keys,j=[],k={};if(c=h.exec(b)){for(f=1,e=c.length;e>f;++f){var l=i[f-1],m="string"==typeof c[f]?decodeURIComponent(c[f]):c[f];l?k[l]=m:j.push(m)}return{params:k,splats:j,route:g.src}}}},d=function(a){a=XQCore.extend({debug:!1},a),this.debug=Boolean(a.debug),this.routes=[],this.routeMap={}};return d.prototype.addRoute=function(b,c){if(!b)throw new Error(" route requires a path");if(!c)throw new Error(" route "+b.toString()+" requires a callback");var d=new a(b);d.fn=c,this.routes.push(d),this.routeMap[b]=c},d.prototype.match=function(a){var b=c(this.routes,a);return b&&(b.fn=this.routeMap[b.route]),b},d.prototype.fire=function(a,b){a=this.match(a),a&&a.fn(b)},d}();